name: Sync README to auto-readme-test

on:
  push:
    branches:
      - main  # ë˜ëŠ” master
    paths:
      - 'README.md'

jobs:
  sync-readme:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout source repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 1
      
      - name: Sync README to target repo
        env:
          TARGET_TOKEN: ${{ secrets.TARGET_REPO_TOKEN }}
          TARGET_REPO: seyun4047/auto-readme-test
        run: |
          # íƒ€ê²Ÿ ì €ì¥ì†Œ í´ë¡ 
          git clone https://x-access-token:${TARGET_TOKEN}@github.com/${TARGET_REPO}.git target-repo
          
          # README ë³µì‚¬
          cp README.md target-repo/README.md
          
          # ë³€ê²½ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
          cd target-repo
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          if git diff --quiet README.md; then
            echo "No changes to README.md"
          else
            git add README.md
            git commit -m "ğŸ”„ Sync README from auto-readme-test-server"
            git push
          fi
